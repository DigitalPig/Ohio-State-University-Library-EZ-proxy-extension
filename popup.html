<script>
  <!-- Copied from NUS EZ proxy extension -->
  <!--  -->
<!--function reload_tab_with_lib_proxy() { -->
    var libproxy = ".proxy.lib.ohio-state.edu";

    chrome.tabs.getSelected(undefined, function(tab) {
	var this_tab_url = tab.url;
        var pos = 0;

	if(this_tab_url.indexOf("http") != 0) {
	    return;
	} else {
	    pos = this_tab_url.indexOf("/", 9);
	}

	var new_url = "http://www.google.com";

	if(pos < 0) {
	    new_url  = this_tab_url + libproxy;
	} else {
	    new_url  = this_tab_url.substring(0, pos);
	    new_url += libproxy;
	    new_url += this_tab_url.substring(pos, this_tab_url.length);
        }

        chrome.tabs.update(tab.id, {url: new_url});
    });


</script>
